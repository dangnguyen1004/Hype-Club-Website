<!DOCTYPE html>
<html lang="en">

<head>
    <title>Hpye!Club</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" type="text/css" href="../css/header_icon.css">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="icon" href="../images/iconTitle.svg" type="image/svg">


    <style>
        .wow:first-child {
            visibility: hidden;
        }
    </style>
    <link rel="stylesheet/less" type="text/css" href="style.less">
    <link
        href='http://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900italic,900'
        rel='stylesheet' type='text/css'>
    <script rel="preload" as="script" crossorigin="anonymous"
        src="https://cdnjs.cloudflare.com/ajax/libs/less.js/3.9.0/less.min.js"></script>

</head>

<body>
    <!-- Start Header  -->
    <header>
        <div class="container">
            <div class="logo">
                <a href="../shoes_shop.php">Hype<span>!</span>Club</a>
            </div>

            <div>
                <a href="" class="bag"><img src="../images/icon/bag.png" alt=""></a>
                <a href="../account/index.html" class="user"><img src="../images/icon/user.png" alt=""></a>
                <a href="javascript:void(0)" class="ham-burger">
                    <span></span>
                    <span></span>
                </a>
            </div>
            <div class="nav">
                <ul>
                    <li><a href="../shoes_shop.php">Home</a></li>
                    <li><a href="../introduce.php">Introduction</a></li>
                    <li><a href="../all_shoes.php">All shoes</a></li>
                    <li><a href="../all_shoes.php">Accessories</a></li>
                    <li><a href="../all_shoes.php">Promotions</a></li>
                    <li><a href="../all_shoes.php">Stores</a></li>
                    <li><a href="../login.php">Account</a></li>
                    <li><a href="../contact.php">Contact</a></li>
                </ul>
            </div>
        </div>
    </header>
    <!-- End Header  -->


    <!-- Start content -->
    <section class="content__profile">
        <div class="container-web">
            <div class="slidebar">

                <div class="userbrief">
                    <div class="left">
                        <img src="./user.png" alt="test" id="avatar">
                    </div>
                    <div class="right">
                        <div class="username" id="userbrief__name">nguyen hai dangdddddsssssssssssssssdddddd</div>
                        <a href="">
                            <img src="./pencil.svg" alt="edit"> Edit profile
                        </a>
                    </div>
                </div>

                <div class="menu">

                    <div class="my_account menu__option">
                        <a href="index.html" class="title">
                            <img src="./account.svg" alt=""> My account
                        </a>
                        <a href="" class="drop-down">Profile</a>
                        <a href="" class="drop-down">Banking</a>
                        <a href="" class="drop-down">Address</a>
                        <a href="index_password.html" class="drop-down">Change password</a>
                    </div>

                    <div class="order menu__option">
                        <a href="">
                            <img src="./files.svg" alt=""> Orders
                        </a>
                    </div>

                    <div class="notification menu__option">
                        <a href="">
                            <img src="./notification.svg" alt=""> Notification
                        </a>
                    </div>

                    <div class="wallet menu__option">
                        <a href="">
                            <img src="./wallet.svg" alt=""> Wallet
                        </a>
                    </div>

                </div>

            </div>

            <div class="innercontent">

                <div class="header">
                    <div class="header__big" id="header__username">
                        Welcome to your account, Đăng Nguyễn
                    </div>
                </div>

                <div class="profile" id="myAccount">

                    <div class="username info">
                        <div class="key">
                            Username
                        </div>
                        <div class="value" id="userAccount">
                            dangnguyen
                        </div>
                    </div>

                    <div class="name info">
                        <div class="key">
                            Name
                        </div>
                        <div class="value">
                            <input type="text" class="text_erea" id="userName">
                        </div>
                    </div>

                    <div class="email info">
                        <div class="key">
                            Email
                        </div>
                        <div class="value">
                            <input type="email" class="text_erea" id="userEmail">
                        </div>
                    </div>

                    <div class="phone info">
                        <div class="key">
                            Phone number
                        </div>
                        <div class="value">
                            <input type="text" class="text_erea" id="userPhone">
                        </div>
                    </div>

                    <div class="ssn info">
                        <div class="key">
                            SSN
                        </div>
                        <div class="value">
                            <input type="text" class="text_erea" id="userSsn">
                        </div>
                    </div>

                    <div class="gender info">
                        <div class="key">
                            Gender
                        </div>
                        <div class="value">
                            <input type="radio" name="gender" value="male">
                            <label for="gender">Male</label>
                            <input type="radio" name="gender" value="female">
                            <label for="gender">female</label>
                            <input type="radio" name="gender" value="other">
                            <label for="gender">Other</label>
                        </div>
                    </div>

                    <div class="birth info">
                        <div class="key">
                            Date of birth
                        </div>
                        <div class="value">
                            <input type="date" class="text_erea" name="birthday" id="userBirth">
                        </div>
                    </div>
                    <div class="updateResponse" id="updateResponse"></div>
                    <div class="save">
                        <input type="button" value="Save" id="btnSave" onclick="updateInfo()">
                        <a href="logout.php">
                            <input type="button" value="Log out" id="btnLogout" onclick="logout()">
                        </a>
                    </div>

                </div>

            </div>
        </div>
        <!--cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc-->
        <div class="container-mobile">
            <div class="header">
                Welcome to your account, Đăng Nguyễn
            </div>

            <div class="userbrief">
                <img src="./35bc210dd5e90b2dcee322340882caa9.jpg" alt="test" class="avatar">
                <div class="username">Đăng Nguyễn</div>
                <a href="">
                    <img src="./pencil.svg" alt="edit"> Sửa hồ sơ
                </a>
            </div>

            <div class="profile">

                <div class="username info">
                    <div class="key">
                        Username
                    </div>
                    <div class="value">
                        dangnguyen
                    </div>
                </div>

                <div class="name info">
                    <div class="key">
                        Name
                    </div>
                    <div class="value">
                        <input type="text" class="text_erea">
                    </div>
                </div>

                <div class="email info">
                    <div class="key">
                        Email
                    </div>
                    <div class="value">
                        <input type="text" class="text_erea">
                    </div>
                </div>

                <div class="phone info">
                    <div class="key">
                        Phone number
                    </div>
                    <div class="value">
                        <input type="text" class="text_erea">
                    </div>
                </div>

                <div class="gender info">
                    <div class="key">
                        Gender
                    </div>
                    <!-- <div class="value">
                        <input type="radio" name="gender" value="male">
                        <label for="gender">Nam</label>
                        <input type="radio" name="gender" value="female">
                        <label for="gender">Nữ</label>
                        <input type="radio" name="gender" value="other">
                        <label for="gender">Khác</label>
                    </div> -->
                </div>

                <div class="birth info">
                    <div class="key">
                        Date of birth
                    </div>
                    <div class="value">
                        <input type="date" class="text_erea" id="" name="birthday">
                    </div>
                </div>

                <div class="save">
                    <input type="button" class="inputStyle" value="Save" id="btnSave">
                    <input type="button" value="Log out" id="btnLogout">
                </div>

            </div>
        </div>
    </section>
    <!-- End content -->


    <!-- Start Contact -->
    <section class="contact" id="contact">
        <div class="container">
            <div class="content">
                <div class="box form wow slideInLeft">
                    <form>
                        <input type="text" placeholder="Enter Name">
                        <input type="text" placeholder="Enter Email">
                        <input type="text" placeholder="Enter Mobile">
                        <textarea placeholder="Enter Message"></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                </div>
                <div class="box text wow slideInRight">
                    <h2>Get Connected with us</h2>
                    <p class="title-p">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem
                        Ipsum has been the industry's standard dummy text ever since the 1500s.</p>
                    <div class="info">
                        <ul>
                            <li><span class="fa fa-map-marker"></span>KTX Khu A DHQG TP HCM, phuong Dong Hoa, thi xa Di
                                An, tinh Binh Duong</li>
                            <li><span class="fa fa-phone"></span> 91 9999999999</li>
                            <li><span class="fa fa-envelope"></span> hypeinfo@gmail.com</li>
                        </ul>
                    </div>
                    <div class="social">
                        <a href=""><span class="fa fa-facebook"></span></a>
                        <a href=""><span class="fa fa-linkedin"></span></a>
                        <a href=""><span class="fa fa-skype"></span></a>
                        <a href=""><span class="fa fa-youtube-play"></span></a>
                    </div>

                </div>
            </div>
        </div>
    </section>
    <!-- End Contact -->

</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- JQuery get info from user -->
<script>
    var userName = '';

    function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }

    function checkCookie() {
        var __username = getCookie("username");
        if (__username != "") {
            userName = __username;
        } else {
            window.location.replace("../login.php");
        }
    }

    function setInfo() {
        $.ajax({
            url: "backend.php",
            type: 'post',
            data: {
                getInfo: 1,
                username: userName
            },
            success: function (data, status) {
                if (data == 'fail') {
                    alert('cant find user');
                } else {
                    info = JSON.parse(data);
                    console.log(info.gender);
                    $('#userAccount').text(info.username);
                    $('#userbrief__name').text(info.username);
                    $('#userName').val(info.name);
                    $('#header__username').text('Welcome to your account, ' + info.name);
                    $('#userEmail').val(info.email);
                    $('#userPhone').val(info.phone);
                    $('#userSsn').val(info.ssn);
                    if (info.gender == 'male') {
                        $('input[name="gender"][value="male"]').prop('checked', true);
                    } else if (info.gender == 'female') {
                        $("input[name=gender][value=female]").prop('checked', true);
                    } else {
                        $("input[name=gender][value=other]").prop('checked', true);
                    }

                    $('#userBirth').val(info.birth);
                    // $('#avatar').html('<img src="getAvatar.php?getAvatar=&username=' + userName + '" alt="test">');
                }
            }
        });
        $.ajax({
            url: "getAvatar.php",
            type: 'post',
            data: {
                getAvatar: 1,
                username: userName
            },
            success: function (data, status) {
                if (data == 'fail'){
                    $("#avatar").attr("src","./user.png");
                }
                else{
                    $("#avatar").attr("src","getAvatar.php?getAvatar=&username="+userName);
                }
            }
        });
        
    }
    checkCookie();
    setInfo();
</script>
<!-- End getInfo -->

<!-- Update info -->

<script>
    function validateEmail(email) {
        if (email == '') return false;
        const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }
    function phonenumber(inputtxt) {
        var vnf_regex = /((09|03|07|08|05)+([0-9]{8})\b)/g;
        if (inputtxt !== '') {
            if (vnf_regex.test(inputtxt) == false) {
                return false;
            } else {
                return true;
            }
        } else {
            return false;
        }
    }
    function validateSsn(ssn) {
        var patt = new RegExp("^\\d{9}$");
        return patt.test(ssn);
    }
    function updateInfo() {
        var name = $('#userName').val();
        var email = $('#userEmail').val();
        var phone = $('#userPhone').val();
        var gender = $('input[name="gender"]:checked').val();
        var birth = $('#userBirth').val();
        var ssn = $('#userSsn').val();

        var check = true;
        if (phonenumber(phone) == false) {
            $('#userPhone').addClass('warning');
            check = false;
        }
        else {
            $('#userPhone').removeClass('warning');
        }
        if (validateEmail(email) == false) {
            $('#userEmail').addClass('warning');
            check = false;
        }
        else {
            $('#userEmail').removeClass('warning');
        }
        if (birth == '') {
            $('#userBirth').addClass('warning');
            check = false;
        }
        else {
            $('#userBirth').removeClass('warning');
        }
        console.log(validateSsn(ssn));
        if (validateSsn(ssn) == false) {
            $('#userSsn').addClass('warning');
            check = false;
        }
        else {
            $('#userSsn').removeClass('warning');
        }


        if (check) {
            $.ajax({
                url: "backend.php",
                type: 'post',
                data: {
                    updateInfo: 1,
                    username: userName,
                    name: name,
                    email: email,
                    phone: phone,
                    ssn: ssn,
                    gender: gender,
                    birth: birth
                },
                success: function (data, status) {
                    if (data == 'fail') {
                        alert('cant find user');
                    } else {
                        setInfo();
                        $('#updateResponse').html('Update infomation success');
                    }
                }
            });
        }
    }
    var rePasswordIsMatch = false;
    function checkRePassword() {
        $('#rePassword').on('blur', function () {
            var rePassword = $('#rePassword').val();
            var newPassword = $('#newPassword').val();
            console.log(rePassword);
            console.log(newPassword);
            if (rePassword == '' || newPassword == '') {
                rePasswordIsMatch = false;
                return
            }
            if (rePassword == newPassword) {
                $('#rePasswordRespone').html("");
                rePasswordIsMatch = true;
                return;
            }
            else {
                $('#rePasswordRespone').html("Re-password is not match");
                rePasswordIsMatch = false;
                return;
            }
        });
    }
    function changePassword() {
        if (rePasswordIsMatch) {
            var oldPassword = $('#oldPassword').val();
            var newPassword = $('#newPassword').val();

            $.ajax({
                url: "backend.php",
                type: 'post',
                data: {
                    changePassword: 1,
                    username: userName,
                    oldPassword: oldPassword,
                    newPassword: newPassword
                },
                success: function (data, status) {
                    if (data == 'OldPasswordNotCorrect'){
                        $('#rePasswordRespone').html('Old password is not correct');
                    }
                    else{
                        $('#changePasswordRespone').html(data);
                    }
                }
            });

        }
    }

</script>


<!-- Script for contact -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        
        checkRePassword();

        $(".ham-burger, .nav ul li a").click(function () {

            $(".nav").toggleClass("open")

            $(".ham-burger").toggleClass("active");
        })
        $(".accordian-container").click(function () {
            $(".accordian-container").children(".body").slideUp();
            $(".accordian-container").removeClass("active")
            $(".accordian-container").children(".head").children("span").removeClass("fa-angle-down").addClass("fa-angle-up")
            $(this).children(".body").slideDown();
            $(this).addClass("active")
            $(this).children(".head").children("span").removeClass("fa-angle-up").addClass("fa-angle-down")
        })

        $(".nav ul li a, .go-down").click(function (event) {
            if (this.hash !== "") {

                event.preventDefault();

                var hash = this.hash;

                $('html,body').animate({
                    scrollTop: $(hash).offset().top
                }, 800, function () {
                    window.location.hash = hash;
                });

                // add active class in navigation
                $(".nav ul li a").removeClass("active")
                $(this).addClass("active")
            }
        })
    })
</script>
<script src="../js/wow.min.js"></script>
<script>
    wow = new WOW({
        animateClass: 'animated',
        offset: 0,
    });
    wow.init();
</script>

</html>